# Calculate movement rate
move_data <- move_data %>%
mutate(move_rate = distance/as.numeric(dt))
View(move_data)
View(trackrng_and_numofloc)
trackrng_and_numofloc <-GPS_per_ind_and_duration %>%
group_by(species) %>%
summarize(min_duration= min(duration)/24 unit="hours",
trackrng_and_numofloc <-GPS_per_ind_and_duration %>%
group_by(species) %>%
summarize(min_duration= min(duration),
max_duration= max(duration),
n_locs= sum(number_of_GPS_locations))
head(move_data)
summary_stats <- move_data %>%
group_by(species, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()),
n = n()
) %>%
arrange(species)
View(bird_data)
move_data <- move_data %>%
left_join(bird_data %>% select(ID, sex))
View(move_data)
summary_stats <- move_data %>%
group_by(ID, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()),
n = n()
) %>%
arrange(species)
move_data <- move_data %>%
left_join(bird_data %>% select(ID, sex,species))
summary_stats <- move_data %>%
group_by(ID, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()),
n = n()
) %>%
arrange(species)
View(move_data)
summary_stats <- move_data %>%
group_by(species, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()),
n = n()
) %>%
arrange(species)
View(summary_stats)
summary_stats <- move_data %>%
summary_stats <- move_data %>%
group_by(species, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()),
arrange(species))
summary_stats <- move_data %>%
group_by(species, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()))
View(summary_stats)
summary_stats <- move_data %>%
group_by(species, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()))
View(summary_stats)
View(move_data_joined)
species_year <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species) %>%
summarize(num_birds=n_distinct(ID))
View(species_year)
species_year <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID))
View(species_year)
pivot_longer(species_year,
cols = species,
names_to = "species",
values_to = "year")
pivot_longer(species_year,
cols = species,
names_to = "species",
values_to = "num_birds")
head(species_year)
head(species_year)
pivot_longer(species_year,
cols = species,
names_to = "species",
values_to = c("2015, 2016,2017,2018,2019"))
View(species_year)
species_year_wide <- species_year %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0)
View(species_year_wide)
species_year_wide <- species_year %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
arrange(year)
species_year_wide <- species_year %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
```
species_year_wide <- species_year %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
```
species_year <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID))
View(species_year)
species_year_wide <- species_year %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
```
species_year_wide <- species_year %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0)
View(species_year_wide)
View(species_year_wide)
species_year_wide <- sort(as.numeric(species_year_wide))
species_year_wide <- sort(as.numeric(species_year_wide_cols))
View(species_year_wide)
species_year_wide <- species_year %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
arrange()
View(species_year_wide)
widemo <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
arrange()
View(widemo)
species_year_wide <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
arrange()
View(species_year_wide)
species_year_wide <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
arrange()
View(species_year_wide)
species_year_wide <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
arrange(year)
species_year_wide <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0),
species_year_wide <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0)
arrange(year)
arrange(species_year_wide,year)
species_year_wide <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0) %>%
arrange(year)
# Read in the data: modify this path as needed
surveys <- read_csv(here("scripts/data/surveys.csv"))
# Calculate the mean and SD weight by species
avg_by_species <- surveys %>%
group_by(species) %>%
summarize(avg_weight = mean(weight, na.rm=T),
sd_weight =sd(weight, na.rm=T))
head(avg_by_species)
# Count the number of observations per combination of habitat types
counts_by_habitat <- surveys %>%
group_by(habitat_class1, habitat_class2, habitat_class3) %>%
summarize(count = n())
counts_by_habitat
View(surveys)
# Calculate median and IQR of sampling hour per species
weight_summary <- surveys %>%
group_by(species) %>%
summarize(median_weight = median(hour(time), na.rm=T),
iqr_weight = IQR(hour(time), na.rm=T))
# Calculate median and IQR of sampling hour per species
weight_summary <- surveys %>%
group_by(species) %>%
summarize(median_hour = median(hour(time), na.rm=T),
iqr_hour = IQR(hour(time), na.rm=T))
View(weight_summary)
# Find the top 2 species with the largest average weight
top2_species <- avg_by_species %>%
arrange(avg_by_species)%>%
slice_head(n=2)
top2_species
biomass_by_species <- surveys %>%
group_by(species) %>%
summarize(total_biomass = mean(weight, na.rm=T)*n())
View(biomass_by_species)
# For each species, calculate the proportion of samples
# in each primary habitat type (habitat class 1)
species_proportions <- surveys %>%
group_by(habitat_class1) %>%
summarize(n = n()) %>%
mutate(proportion = n/sum(n) )
View(species_proportions)
View(species_proportions)
head(surveys)
most_common_habitat <- surveys %>%
pivot_longer(cols = starts_with("habitat_class"), names_to = "class_level", values_to = "habitat") %>%
group_by(species, habitat) %>%
summarise(freq = n(), .groups = "drop") %>%
group_by(species) %>%
slice_max(freq, n = 1, with_ties = FALSE) %>%
arrange(species)
View(most_common_habitat)
# Simulate hindfoot lengths for the survey data
set.seed(1) # Setting the seed makes the random sample come out the same each time
# Randomly sample from a normal distribution with mean of 15 and SD of 5
# The number of elements should be the same as the number of surveys
hindfoot_length_mm <- rnorm(n = nrow(surveys), mean = 15, sd = 5)
hist(hindfoot_length_mm)
# Add this column to the survey data
surveys <- surveys %>%
mutate(hindfoot_mm = hindfoot_length_mm)
View(surveys)
# Add in a new season of data from the surveys_2023 data set
surveys_2023 <- read_csv("data/surveys_2023.csv")
surveys_augmented <- bind_rows(surveys, surveys_2023)
View(surveys_augmented)
# Summarize to make sure binding worked
## Check that number of rows is as expected
nrow(surveys_augmented) == (nrow(surveys) + nrow(surveys_2023))
## Check whether NAs were introduced by counting the number of NAs in each column
NA_counts <- surveys_augmented %>%
summarize(across(everything(), ~sum(is.na())))
## Check whether NAs were introduced by counting the number of NAs in each column
NA_counts <- surveys_augmented %>%
summarize(across(everything(), ~sum(is.na())))
## Check whether NAs were introduced by counting the number of NAs in each column
NA_counts <- surveys_augmented %>%
summarize(across(everything(), ~sum(is.na(.))))
pivot_longer(NA_counts, everything())
View(surveys_2023)
# Make sure names match and redo binding
surveys_2023 <- rename(surveys_2023, sampling_date = date)
# Make sure names match and redo binding
surveys_2023 <- rename(surveys_2023, "sampling_date" = "date")
View(NA_counts)
# Make sure names match and redo binding
surveys_2023 <- rename(surveys_2023, sampling_date = date)
# Make sure names match and redo binding
names(surveys)
names(surveys_2023)
# Make sure names match and redo binding
names(surveys)
names(surveys_2023)
surveys_2023 <- rename(surveys_2023, sampling_date = date)
surveys_2023 <- rename(surveys_2023, date=sampling_date)
surveys_augmented <- bind_rows(surveys, surveys_2023)
View(surveys_augmented)
# Read in the species info file
species_info <- read_csv(here("scripts/data/species_info.csv"))
# Join the two datasets using species as the key
surveys_joined <- surveys %>%
left_join(species_info, by = "species")
# Check to see if this worked
unique(surveys_joined$common_name)
# Join the summarized datasets with species info
avg_by_species <- avg_by_species %>%
left_join(species_info)
# Use an inner join
surveys_inner <- surveys %>%
inner_join(species_info, by = "species")
# Compare row counts between the left and inner joins
(nrow(surveys_joined) == nrow(surveys_inner))
# Semi join: keep only surveys for native species
native_surveys <- surveys %>%
semi_join(species_info %>% filter(status=="native"), by = "species")
nrow(native_surveys)
nrow(surveys)
# Anti join: find species never observed in surveys
unobserved_species <- species_info %>%
anti_join(surveys_inner, by = "species")
View(unobserved_species)
View(surveys_inner)
# Summarize number of samples per species per habitat type 1
species_habs <- surveys %>%
group_by(species, habitat_class1) %>%
summarize(n = n())
View(species_habs)
# Create a table with species as rows and habitat type as columns
# Where any missing species-habitat combinations are filled with zero
species_habs_wide <- pivot_wider(species_habs,
names_from = species, habitat_class1,
values_from = n,
values_fill = 0)
species_habs_wide
species_habs_long <- pivot_longer(species_habs_wide,
cols = -habitat_class1,
names_to = "species",
values_to = "count")
View(species_habs_long)
View(species_habs_wide)
# Create table where each row is a year and
# columns are counts per the combination of habitat types 1 and habitat type 2
# Fill any missing species-habitat combinations with zero !!!STILL NEED TO VISIT!!!
year_plot_counts <- surveys %>%
group_by(year,habitat_class1, habitat_class2) %>%
summarize(n = n()) %>%
pivot_wider(names_from = habitat_class1, values_from = n,
values_fill = 0)
year_plot_counts
View(year_plot_counts)
# Create table where each row is a year and
# columns are counts per the combination of habitat types 1 and habitat type 2
# Fill any missing species-habitat combinations with zero !!!STILL NEED TO VISIT!!!
year_plot_counts <- surveys %>%
group_by(year) %>%
summarize(n = n()) %>%
pivot_wider(names_from = habitat_class1, values_from = n,
values_fill = 0)
# Create table where each row is a year and
# columns are counts per the combination of habitat types 1 and habitat type 2
# Fill any missing species-habitat combinations with zero !!!STILL NEED TO VISIT!!!
year_plot_counts <- surveys %>%
group_by(year, habitat_class1, habitat_class2) %>%
summarize(n = n()) %>%
pivot_wider(names_from = habitat_class1, values_from = n,
values_fill = 0)
View(year_plot_counts)
# Create table where each row is a year and
# columns are counts per the combination of habitat types 1 and habitat type 2
# Fill any missing species-habitat combinations with zero !!!STILL NEED TO VISIT!!!
year_plot_counts <- surveys %>%
group_by(year, habitat_class1, habitat_class2) %>%
summarize(count = n()) %>%
pivot_wider(names_from = habitat_class1, values_from = n,
values_fill = 0)
# Create table where each row is a year and
# columns are counts per the combination of habitat types 1 and habitat type 2
# Fill any missing species-habitat combinations with zero !!!STILL NEED TO VISIT!!!
year_plot_counts <- surveys %>%
group_by(year, habitat_class1, habitat_class2) %>%
summarize(count = n(), .groups = drop) %>%
pivot_wider(names_from = habitat_class1, values_from = n,
values_fill = 0)
year_plot_counts <- surveys %>%
group_by(year, habitat_class1, habitat_class2) %>%
summarize(n = n()) %>%
unite("habitat_combo", habitat_class1, habitat_class2, sep = "_") %>%
pivot_wider(names_from = habitat_class1, values_from = n,
values_fill = 0)
View(surveys)
year_plot_counts <- surveys %>%
group_by(year, habitat_class1, habitat_class2) %>%
summarize(count = n(), .groups = "drop") %>%
unite("habitat_combo", habitat_class1, habitat_class2, sep = "_") %>%
pivot_wider(
names_from = habitat_combo,
values_from = count,
values_fill = list(count = 0)
)
View(year_plot_counts)
year_plot_counts <- surveys %>%
group_by(year, habitat_class1, habitat_class2) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(habitat_combo = str_c(habitat_class1, habitat_class2, sep = "_")) %>%
pivot_wider(
names_from = habitat_combo,
values_from = count,
values_fill = list(count = 0)
)
View(year_plot_counts)
year_plot_counts <- surveys %>%
group_by(year, habitat_class1, habitat_class2) %>%
summarize(count = n(), .groups = "drop") %>%
mutate(habitat_combo = str_c(habitat_class1, habitat_class2, sep = "_")) %>%
select(year, habitat_combo, count) %>%
pivot_wider(
names_from = habitat_combo,
values_from = count,
values_fill = list(count = 0)
)
View(year_plot_counts)
year_plot_counts
# Reshape avg_weight and sd_weight to long format
species_stats_long <- avg_by_species %>%
pivot_longer(cols = c(avg_weight, sd_weight),
names_to = "statistic",
values_to = "value")
View(species_stats_long)
# Reformat the "statistic" column so that values are "mean" and "sd"
# Hint: you could do this with stringr or if_else
species_stats_long <- species_stats_long %>%
mutate(statistic = if_else(statistic == "avg_weight", "mean", statistic))
species_stats_long <- species_stats_long%>%
mutate(statistic = if_else(statistic == "sd_weight", "sd", statistic))
head(species_stats_long)
View(avg_by_species)
# Read in the individual-level data
bird_data <- read_csv(here("scripts/data/individual_data_attributes.csv"))
# Check the column formats and correct as needed (hint: check time columns)
str(bird_data)
str(move_data)
# Read in the movement data
move_data <- read_csv(here("scripts/data/local_movement_data.csv"))
# Check the column formats and correct as needed (hint: check time columns)
str(bird_data)
str(move_data)
bird_data <- bird_data %>%
mutate(sampling_date = mdy(sampling_date))
move_data <- move_data %>%
mutate(timestamp = mdy_hm(timestamp))
move_data <- move_data %>%
mutate(long_lat= str_c(longitude, latitude, sep=", "))
GPS_per_ind <- move_data %>%
group_by(ID) %>%
summarize(number_of_GPS_locations=n())
View(GPS_per_ind)
range(GPS_per_ind$number_of_GPS_locations)
GPS_per_ind_and_duration <- move_data %>%
group_by(ID) %>%
summarize(number_of_GPS_locations=n(),
start_time=min(timestamp),
end_time=max(timestamp),
duration=difftime(end_time, start_time, units="hours"))
View(GPS_per_ind_and_duration)
# What is the range of tracking duration?
range(GPS_per_ind_and_duration$duration)
contigency_table <- bird_data %>%
count(active_infection, antibody_detection)
View(contigency_table)
move_data_joined <- move_data %>%
left_join(bird_data %>% select(ID, active_infection, antibody_detection, species, sex))
View(move_data_joined)
GPS_per_ind_and_duration <- GPS_per_ind_and_duration %>%
left_join(bird_data %>% select(ID, active_infection, antibody_detection, species, sex))
trackrng_and_numofloc <-GPS_per_ind_and_duration %>%
group_by(species) %>%
summarize(min_duration= min(duration),
max_duration= max(duration),
n_locs= sum(number_of_GPS_locations))
View(trackrng_and_numofloc)
View(trackrng_and_numofloc)
# Add a movement rate column to the movement data (i.e., distance traveled per hour)
# For now, we will just use latitude and longitude as your location data (don't worry
# about the fact that you're caclulating distances in decimal degrees).
move_data <- move_data %>%
group_by(ID) %>%
mutate(lag_longitude = lag(longitude), lag_latitude = lag(latitude)) %>%
mutate(distance = sqrt((longitude - lag_longitude)^2 + (latitude - lag_latitude)^2))
# Add a time difference column
move_data <- move_data %>%
mutate(dt = difftime(timestamp, lag(timestamp), units = "hours"))
# Calculate movement rate
move_data <- move_data %>%
mutate(move_rate = distance/as.numeric(dt))
move_data <- move_data %>%
left_join(bird_data %>% select(ID, sex,species))
summary_stats <- move_data %>%
group_by(species, sex) %>%
summarise(
mean_movement = mean(move_rate, na.rm = TRUE),
se_movement = sd(move_rate, na.rm = TRUE) / sqrt(n()))
View(summary_stats)
species_year_wide <- move_data_joined %>%
mutate(year=year(timestamp)) %>%
group_by(species,year) %>%
summarize(num_birds=n_distinct(ID)) %>%
pivot_wider(names_from = year,
values_from = num_birds,
values_fill = 0)
View(species_year_wide)
